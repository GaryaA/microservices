# Summary: Section 4 - Handle Deployment, Portability & Scalability using Docker

## Обзор секции

В четвертой секции курса изучалась контейнеризация микросервисов с использованием Docker. Были рассмотрены различные способы создания Docker образов и управления контейнерами для обеспечения портативности и масштабируемости приложений.

## Что было изучено

### 1. Docker основы
- Понимание концепции контейнеризации
- Преимущества Docker для микросервисов:
  - Портативность приложений
  - Изоляция зависимостей
  - Масштабируемость
  - Консистентность окружений

### 2. Создание Dockerfile
- Структура Dockerfile:
  - `FROM` - базовый образ (openjdk:21-jdk-slim)
  - `LABEL` - метаданные образа
  - `COPY` - копирование файлов в образ
  - `ENTRYPOINT` - команда запуска приложения
- Оптимизация Dockerfile для минимального размера образа
- Использование slim версий базовых образов

### 3. Сборка Docker образов
- Команда `docker build` для создания образов
- Тегирование образов (например, `eazybytes/accounts:s4`)
- Просмотр созданных образов через `docker images`
- Инспекция образов через `docker image inspect`

### 4. Управление Docker образами
- Загрузка образов в реестр (`docker image push`)
- Загрузка образов из реестра (`docker image pull`)
- Удаление образов (`docker image rm`)
- Управление версиями образов через теги

### 5. Запуск контейнеров
- Команда `docker run` для запуска контейнеров
- Маппинг портов (`-p host:container`)
- Управление контейнерами:
  - `docker ps` - список запущенных контейнеров
  - `docker ps -a` - все контейнеры
  - `docker container start/stop/restart` - управление жизненным циклом
  - `docker container logs` - просмотр логов
  - `docker container inspect` - детальная информация

### 6. Docker Compose
- Создание `docker-compose.yml` для оркестрации нескольких контейнеров
- Определение сервисов (accounts, cards, loans)
- Настройка сетей (bridge network)
- Ограничение ресурсов через `deploy.resources.limits`
- Управление через команды:
  - `docker compose up` - запуск всех сервисов
  - `docker compose down` - остановка и удаление
  - `docker compose start/stop` - управление без пересоздания

### 7. Альтернативные способы создания образов
- **Buildpacks** - автоматическая сборка через `mvn spring-boot:build-image`
  - Не требует Dockerfile
  - Автоматическая оптимизация
- **Google Jib** - через `mvn compile jib:dockerBuild`
  - Инкрементальная сборка
  - Кэширование слоев
  - Не требует Dockerfile

### 8. Сетевые возможности Docker
- Создание пользовательских сетей
- Изоляция контейнеров в отдельных сетях
- Коммуникация между контейнерами через имена сервисов

## Что было реализовано

### Dockerfile для микросервисов
```dockerfile
FROM openjdk:21-jdk-slim
LABEL "org.opencontainers.image.authors"="eazybytes.com"
COPY target/accounts-0.0.1-SNAPSHOT.jar accounts-0.0.1-SNAPSHOT.jar
ENTRYPOINT ["java", "-jar", "accounts-0.0.1-SNAPSHOT.jar"]
```

### Docker Compose конфигурация
- **Accounts service**: порт 8080, лимит памяти 700m
- **Cards service**: порт 9000, лимит памяти 700m
- **Loans service**: порт 8090, лимит памяти 700m
- Общая сеть `eazybank` для всех сервисов

### Интеграция с Maven
- Настройка Jib plugin в `pom.xml` для автоматической сборки образов
- Конфигурация тегов образов через Maven

## Технические детали

### Базовые образы
- OpenJDK 21 slim версия для уменьшения размера
- Оптимизация для production окружений

### Управление ресурсами
- Ограничение памяти через `deploy.resources.limits.memory`
- Предотвращение утечек памяти
- Контроль использования ресурсов

### Сетевая изоляция
- Bridge network для изоляции микросервисов
- Возможность масштабирования отдельных сервисов

## Best Practices

1. **Использование slim образов** - уменьшение размера и времени загрузки
2. **Многоэтапная сборка** - оптимизация для production
3. **Тегирование версий** - отслеживание версий образов
4. **Ограничение ресурсов** - предотвращение перегрузки хоста
5. **Изоляция сетей** - безопасность и организация
6. **Использование Buildpacks/Jib** - упрощение процесса сборки

## Результаты секции

После завершения четвертой секции студенты:
1. Умеют создавать Dockerfile для Spring Boot приложений
2. Понимают процесс сборки и управления Docker образами
3. Знают, как использовать Docker Compose для оркестрации
4. Умеют применять альтернативные инструменты (Buildpacks, Jib)
5. Понимают важность ограничения ресурсов
6. Знают best practices для контейнеризации микросервисов

## Следующие шаги

В следующих секциях курса будут изучены:
- Cloud Native принципы и 15-Factor методология (Section 5)
- Управление конфигурациями (Section 6)
- Использование production баз данных (Section 7)
- Service Discovery (Section 8)
- API Gateway (Section 9)

